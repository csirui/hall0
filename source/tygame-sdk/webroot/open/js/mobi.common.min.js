function hlog(a){if(window.parent){var b=parent.window.log;if(b){b(a)}}}var TY={},myglobal={};var mydebug=true;var user,clientId,simpay="false",phoneType="unknown";TY.nativeActions={};TY.JSONAPIVER="v1/";TY.delaytime=-1;TY.domain=document.location.protocol+"//"+document.location.host+"/";TY.domainlocal=TY.domaincross=TY.domain;TY.showWaiting=function(c){var a="<div class='waiting'><span class='waiting_box'>"+c+"</span></div>";$($("body")[0]).append(a);var b=($(".waiting")[0].clientWidth-$(".waiting_box")[0].clientWidth)/2;$(".waiting_box").css("left",b+"px")};TY.hideWaitting=function(){var a=$(".waiting")[0];if(a&&a.parentNode){a.parentNode.removeChild(a)}};TY.showMessage=function(d,c){var a="<div class='message'><span class='message_box'>"+d+"</span></div>";$($("body")[0]).append(a);var b=($(".message")[0].clientWidth-$(".message_box")[0].clientWidth)/2;setTimeout("TY.hideMessage()",c==undefined?2000:c)};TY.hideMessage=function(){var a=$(".message")[0];if(a&&a.parentNode){a.parentNode.removeChild(a)}};TY.iosArgList=[];TY.iosCallTimer=0;TY.jsCallNativeIOS=function(){try{var a=TY.iosArgList.shift();if(a){document.location="http://javascript.call.ios.native?"+a}if(TY.iosArgList.length>0){setTimeout(TY.jsCallNativeIOS,30)}else{TY.iosCallTimer=0}}catch(b){}};TY.jsCallNative=function(params){if(TY.delaytime<0){TY.delaytime=1;var p=window.parent;if(p){var plog=parent.window.log;if(plog){TY.delaytime=20;os_type="unknown"}}}var timeout=30;var args=JSON.stringify(params);if(os_type=="ios"){TY.iosArgList.push(encodeURIComponent(args));if(TY.iosCallTimer==0){TY.iosCallTimer=1;setTimeout(TY.jsCallNativeIOS,timeout)}return}function caller(){var obj=window._javascript_4_java_;if(!obj&&os_type=="unknown"){setTimeout(caller,timeout);return}try{args=args.replace(/\\/g,"\\\\");args=args.replace(/\'/g,"\\'");eval("window._javascript_4_java_.exec('"+args+"')")}catch(e){}}setTimeout(caller,timeout)};var AnonyJSFuncN=0;TY.callNative=function(d,a,e,g){var f="";if(g&&typeof(g)=="function"){f=g.name;if(f.length<=0){f="_AN_JS_F_"+AnonyJSFuncN++}if(a=="PageInit"){TY.regAction(f,function(j,h,c){var i=j.server;if(i){TY.domaincross=j.server}g(j,h,c)})}else{TY.regAction(f,g)}}var b={module:d,callback:f,cmd:{action:a,params:e}};TY.jsCallNative(b)};TY.regAction=function(b,a){TY.nativeActions[b]=a};myglobal.nativeCallJs=function(b){var a=null;try{a=JSON.parse(b);var d=a.cmd;action=d.action;params=d.params;error=d.error;var c=(error!=undefined&&error.code)?true:false;var g=(c)?error.info:"";fun=TY.nativeActions[action];if(typeof(fun)=="function"){if(c){TY.callNativeShow();TY.showMessage("系统错误！ "+g)}else{if(action=="OnPageInit"){phoneType=params.phoneType;clientId=params.clientId;user=params.user;simpay=params.simpay;TY.callNativeShow()}}fun(params,c,g);return"ok"}else{return"error"}}catch(f){TY.callNativeShow();return"exception"}};TY.getLocalMsg=function(c,a){var e=local_msg_current[""+c];if(e){if(a){for(var b=0;b<a.length;b++){var d=new RegExp("\\$\\{"+b+"\\}","g");e=e.replace(d,""+a[b])}}return e}hlog("System Error, Message Key Bot Found ->"+c);return"System Message Error"};TY.doRequest=function(d,b,f){if(b==undefined){b="json"}if(f==undefined){f="POST"}if(d.cache==undefined){d.cache=false}hlog("JSON request ->type="+b+" method="+f+" action="+JSON.stringify(d));var e=function(g,i,h){hlog("JSON response error->"+d.method+" error->"+h);TY.hideWaitting();data={error:{code:-99,info:TY.getLocalMsg("neterr")}};d.callback(data,d,false)};var c=function(h,i,g){hlog("JSON response->"+d.method+JSON.stringify(h));TY.hideWaitting();result=true;if(h==null||h.error!=undefined){result=false}d.callback(h,d,result)};if(d.method.indexOf("http://")<0){d.method=TY.domain+d.method}var a={dataType:b,cache:d.cache,type:f,url:d.method,error:e,success:c,data:d.params};$.ajax(a)};TY.getUrlParam=function(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)");var c=window.location.search.substr(1).match(b);if(c!=null){return decodeURIComponent(c[2])}return null};TY.intval=function(a){a=parseInt(a);return isNaN(a)?0:a};TY.bindTouchClick=function(c,d,b){var a=false;if(document.ontouchstart===undefined){c.click(function(e){if(b==false){e.stopPropagation()}d(this,e)});return}c.bind("touchstart",function(e){a=true;if(b==false){e.stopPropagation()}if(e.name=="click"){d(this,e)}});c.bind("touchmove",function(e){a=false});c.bind("touchend",function(e){if(b==false){e.stopPropagation()}if(a){d(this,e)}})};TY.resetDivOuterHeight=function(){var a=document.documentElement.clientHeight;$(".div_outer").css("height",a+"px")};TY.showAlertStyle=function(e,d,b,f,c,a){TY.showAlert(e,d,f,c,a,b)};TY.showAlert=function(g,b,h,a,i,e){if(e==undefined){e=""}var c=TY.getLocalMsg("but_ok");var d='<div class="alert '+e+'"><div class="alert_box"><table border="0" cellspacing="0" cellpadding="0"><tr valign="bottom" class="alert_line1"><td align="center">'+g+'</td><tr valign="middle" class="alert_line2"><td align="center">'+b+'</td></tr><tr valign="top"><td align="center"><a class="green_button alert_ok" href="javascript:;">'+c+"</a></td></tr></table></div></div>";var f=$("body");$(f).append(d);if(isNaN(a)){a=f.clientWidth}if(isNaN(i)){i=f.clientHeight}$(".alert").css({width:a,height:i});$(".alert_ok").bind("click",function(){$(".alert").remove();if(typeof(h)=="function"){h()}})};TY.showChoiceYesNo=function(f,e,g){var a=TY.getLocalMsg("but_ok");var d=TY.getLocalMsg("but_cancel");var b='<div class="alert"><div class="alert_box"><table border="1" cellspacing="0" cellpadding="0"><tr valign="bottom" class="alert_line1"><td colspan="2" align="center">'+f+'</td><tr valign="middle" class="alert_line2"><td colspan="2" align="center">'+e+'</td></tr><tr valign="top"><td align="center"><a class="green_button choice_yes" href="javascript:;">'+a+'</a></td><td align="center"><a class="gray_button choice_no" href="javascript:;">'+d+"</a></td></tr></table></div></div>";var c=$("div")[0];$(c).append(b);$(".alert").css({width:c.clientWidth+"px",height:c.clientHeight+"px"});$(".choice_yes").bind("click",function(){$(".alert").remove();if(typeof(g)=="function"){g(true)}});$(".choice_no").bind("click",function(){$(".alert").remove();if(typeof(g)=="function"){g(false)}})};TY.updateTabLayout=function(){var a=document.documentElement.clientHeight;var c=$(".header")[0].clientHeight;var b=a-c-30;if($(".content").length<=0){return}$(".content").css("height",b+"px")};TY.bindUiTab=function(c,b){c=c+">li";var a=$(c);TY.bindTouchClick(a,function(f,e){if(f.className=="current"){return}var d=$(c+".current");d.removeClass("current");f.className="current";b(f)})};TY.switchSelectItem=function(b,d,c){var e=$(b).eq(d);if($(e).hasClass("cur")){if(c){$(e).removeClass("cur");return false}return true}var a=$(b+".cur");a.removeClass("cur");$(e).addClass("cur");return true};TY.showDialog=function(a){console.log(a);$("#"+a).css("display","block");var b=$("#"+a)[0].children[0];b.style.height=b.clientHeight+"px"};TY.closeDialog=function(a){$(a).parents(".dialog").css("display","none")};TY.isCallNativeShow=false;TY.callNativeShow=function(){if(TY.isCallNativeShow==false){TY.isCallNativeShow=true;TY.callNative("common","doPageShow",{})}};TY.callNativeClose=function(){TY.callNative("common","CloseWindow",{})};TY.callNativeUpdateUser=function(){TY.callNative("user","UpUserInfo",{})};var os_type="unknown";checkSystemInit();var is_android_2x=false;function checkSystemInit(){protocol=document.location.protocol;if(navigator.userAgent.match(/android/i)){os_type="android";if(protocol.indexOf("file")==0){TY.domainlocal="file:///android_asset/"}}else{if(navigator.userAgent.match(/iPhone|iPod|iPad/i)){os_type="ios"}}}function isAndroid2x(){if(is_android_2x||navigator.userAgent.match(/android.2\./i)){is_android_2x=true;return true}return false}$().ready(function(){TY.regAction("backClick",backclick)});function checkScreenDpi(){var a=document.getElementsByName("viewport")[0];if(window.screen.availWidth<500||window.screen.availWidth<1000){if(os_type=="android"){a.setAttribute("content","target-densitydpi=195, width=device-width, user-scalable=no")}if(os_type=="ios"){a.setAttribute("content","initial-scale=0.75,maximum-scale=1.0,minimum-scale=0.5,user-scalable=1,width=640")}}if(window.screen.availWidth<860){if(os_type=="android"){a.setAttribute("content","target-densitydpi=195, width=device-width, user-scalable=no")}if(os_type=="ios"){a.setAttribute("content","initial-scale=0.75,maximum-scale=1.0,minimum-scale=0.5,user-scalable=1,width=640")}}}backclick=function(c,b,a){TY.callNativeClose()};TY.regAction("OnUserInfoChanged",OnUserInfoChanged);function OnUserInfoChanged(c,b,a){if(!b){user=c.user}}TY.getClientId=function(c){var a=c.clientId;if(a==undefined){var b=c.user;if(b!=undefined){a=b.clientId}}if(a==undefined){a=""}return a};TY.getClientVersion=function(d){var b=TY.getClientId(d);var c=b.split("_");var a=parseFloat(c[1]);if(isNaN(a)){return 0}return a};